<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
    <meta charset="UTF-8"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <title>Ortografia</title>
    <style>
        .lettercell {
        table-layout:fixed;
        width:20px;
        overflow:hidden;
        word-wrap:break-word;
        }
        .btn {
            background-color: rgb(161, 56, 152);
            color: white;
            border: none;
            cursor: pointer;
            padding: 2px 12px 3px 12px;
            text-decoration: none;
        }
        .rowB {
            padding-top: 1.5rem;
            padding-bottom: 1.5rem;
            margin-left: -10px;
            margin-right: -10px;
        }
        .answer_good {
            background-color: rgb(168, 201, 177);
            color: #034b1e;
        }
        .answer_bad {
            background-color: rgb(204, 160, 160);
            color: #ae0505;
        }
    </style>
</head>
	
<body onKeyPress="return handleEnterKey(event)">

    <div class="container" >
      
    <div class="jumbotron">
        <h4>Nauka ortografii</h4>
    </div>

    <div class="row"> 
        <div class="col">
            Zadanie nr <span id="quest_no_title">1</span> (zadania z <span id="max_range_title">h i ch</span>):
            <hr/>
        </div>
    </div>


    <div class="row" id="quest">
        <table class="table table-bordered">
            <tr>
                <td hidden="true" id="letter_0" class="lettercell"></td>
                <td hidden="true" id="letter_1" class="lettercell"></td>
                <td hidden="true" id="letter_2" class="lettercell"></td>
                <td hidden="true" id="letter_3" class="lettercell"></td>
                <td hidden="true" id="letter_4" class="lettercell"></td>
                <td hidden="true" id="letter_5" class="lettercell"></td>
                <td hidden="true" id="letter_6" class="lettercell"></td>
                <td hidden="true" id="letter_7" class="lettercell"></td>
                <td hidden="true" id="letter_8" class="lettercell"></td>
                <td hidden="true" id="letter_9" class="lettercell"></td>
                <td hidden="true" id="letter_10" class="lettercell"></td>
                <td hidden="true" id="letter_11" class="lettercell"></td>
                <td hidden="true" id="letter_12" class="lettercell"></td>
            </tr>
        </table>
    </div>

    <dic class="row rowB" id="answer_row">
        <div class="col-3"></div>

        <div class="col-2 input-group input-group-lg">
            <button onclick="answerA()" class="btn" id="answerA">CH</button>
        </div>
        <div class="col-1"></div>
        <div class="col-2 input-group input-group-lg">
            <button onclick="answerB()" class="btn" id="answerB">H</button>
        </div>
        <div class="col-4"></div>
    </dic>

    <div class="row rowB" id="answ_ok" hidden="true">
        <div class="col-8" style="font-weight: bold; font-size: large; color: green; text-align:center"> 
		    Dobrze! <span id="emot_good">😀</span>
        </div>
		<div class="col-4">
			<button class="btn btn-secondary btn-block" onclick="prepare()" >Dalej</button>    
		</div>
    </div>

    <div class="row rowB" id="answ_bad" hidden="true">
        <div class="col-8" style="font-weight: bold; font-size: large; color: red; text-align:center"> 
		    Niestety, zła odpowiedź <span id="emot_bad">😢</span>
        </div>
		<div class="col-4">
                <button class="btn btn-secondary btn-block" onclick="prepare()" >Dalej</button>    
        </div>
    </div>

    <div class="row">
        <div class="col">
            <hr/>
        </div>
    </div>

    <div class="row">
            <div class="col">
                <a href="#" data-toggle="modal" data-target="#setWordList" role="button">Wybierz zestaw zadań..</a> 
                <br/>
                <a href="#" data-toggle="modal" data-target="#showErrs" role="button">Pokaż błędy...</a>
                <hr/>
            </div>
    </div>

    <div class="row">
        <div class="col">
                <span style="text-decoration:underline">Statystyki:</span> <br/>
                Liczba zadań: <span id="quests_no">0</span> <br/>
                Poprawnych odpowiedzi: <span id="oks_no">0</span> <br/>
                Błędnych odpowiedzi: <span id="errs_no">0</span> <br/>
        </div>
	</div>
	
    <div class="row">
        <div class="col" style="font-size: small; text-align:right">
                v. 1.0.9
        </div>
	</div>

    </div>

    <script>
        var buttonA = "CH";
        var buttonB = "H";
        var aWord = "";
        var answer = "";
        var questNo = 0;
        var correctAnswers = 0;
        var wrongAnswers = 0;
        var appState = 0;
        var wordsList01 = [];
        var wordsList02 = [];
        var wordsList03= [];
        initializeWordsList();
        var wordsList = wordsList01;

        var emots_good = ["😎", "😊", "👍", "💪", "🐣", "🌈", "♥️", "🤩", "😺", "🤗"];
        var emots_bad = ["😢", "😞", "😔", "😩", "😣","🙉", "😱", "👎", "💩", "💔"];

        function reset() {
            aWord = "";
            answer = "";
            questNo = 0;
            correctAnswers = 0;
            wrongAnswers = 0;
            appState = 0;
            document.getElementById("list_of_errors").innerHTML = "Jak na razie nie ma żadnych błędów!";
        }

        function prepare() {
            var randomIndex = Math.floor(Math.random() * wordsList.length);
            aWord = wordsList[randomIndex].word;
            answer = wordsList[randomIndex].answer;
            questNo++;      
            appState = 0;
            for (var i=0; i<aWord.length; i++) {
                var letterId = "letter_" + i;
                document.getElementById(letterId).innerHTML = aWord.toUpperCase().charAt(i);
                document.getElementById(letterId).hidden = false;
                if (aWord.charAt(i) === "_") {
                    document.getElementById(letterId).innerHTML = '<input type="text" id="answer" autocapitalize="on" maxlength="2" size="2" autofocus />';
                }
            }
            for (var j=aWord.length; j<13; j++) {
                var letterId2 = "letter_" + j;
                document.getElementById(letterId2).innerHTML = "";
                document.getElementById(letterId2).hidden = true;
            }
            document.getElementById("answ_ok").hidden = true;
            document.getElementById("answ_bad").hidden = true;
            document.getElementById("answer_row").hidden = false;
            document.getElementById("answer_row").focus();
            document.getElementById("answer").classList.remove("answer_good");
            document.getElementById("answer").classList.remove("answer_bad");
        };


        function check() {
            document.getElementById("emot_good").innerHTML = emots_good[Math.floor(Math.random() * emots_good.length)];
            document.getElementById("emot_bad").innerHTML = emots_bad[Math.floor(Math.random() * emots_bad.length)];
            var userAnswer = document.getElementById("answer").value;
            if (userAnswer.toLowerCase() === answer.toLowerCase()) {
                correctAnswers++;
                document.getElementById("answ_ok").hidden = false;
                document.getElementById("answ_bad").hidden = true;
                document.getElementById("answer_row").hidden = true;
                document.getElementById("answer").classList.add("answer_good");
            } else {
                wrongAnswers++;
                var errorEntry = "<li>" + aWord.replace("_", "<b>__</b>") + " (prawidłowa odpowiedź: <b>" + answer + "</b>)</li>";
                if (wrongAnswers === 1) { 
                    document.getElementById("list_of_errors").innerHTML = errorEntry;
                } else {
                    document.getElementById("list_of_errors").innerHTML += errorEntry;
                }
                document.getElementById("answ_ok").hidden = true;
                document.getElementById("answ_bad").hidden = false;
                document.getElementById("answer_row").hidden = true;
                document.getElementById("answer").classList.add("answer_bad");
            }
            appState = 1;
            updateStats();
        };

        function updateStats() {
            document.getElementById("quest_no_title").innerHTML = questNo;
            document.getElementById("quests_no").innerHTML = questNo;
            document.getElementById("oks_no").innerHTML = correctAnswers;
            document.getElementById("errs_no").innerHTML = wrongAnswers;
        };

        function answerA() {
            document.getElementById("answer").value = buttonA;
            check();
        }

        function answerB() {
            document.getElementById("answer").value = buttonB;
            check();
        }   

        function handleEnterKey(e) {
            if((e && e.keyCode == 13) || e == 0) {
                if (appState===0) {
                    check();
                }  else if (appState===1) {
                    prepare();
                }
            }
        }

        function setWordList01() {
            wordsList = wordsList01;
            buttonA = "CH";
            buttonB = "H";
            reset();
            prepare();
            updateStats();
            document.getElementById("answerA").innerHTML = buttonA;
            document.getElementById("answerB").innerHTML = buttonB;
            document.getElementById("max_range_title").innerHTML = "h i ch";
        };

        function setWordList02() {
            wordsList = wordsList02;
            buttonA = "RZ";
            buttonB = "Ż";
            reset();
            prepare();
            updateStats();
            document.getElementById("answerA").innerHTML = buttonA;
            document.getElementById("answerB").innerHTML = buttonB;
            document.getElementById("max_range_title").innerHTML = "rz i ż";
        };

        function setWordList03() {
            wordsList = wordsList03;
            buttonA = "U";
            buttonB = "Ó";
            reset();
            prepare();
            updateStats();
            document.getElementById("answerA").innerHTML = buttonA;
            document.getElementById("answerB").innerHTML = buttonB;
            document.getElementById("max_range_title").innerHTML = "u i ó";
        };


        function initializeWordsList() {
            wordsList01 = [
                { "word": "_uśtawka", "answer": "h" },
                { "word": "sza_y", "answer": "ch" },
                { "word": "_alka", "answer": "h" },
                { "word": "du_", "answer": "ch" },
                { "word": "_mura", "answer": "ch" },
                { "word": "_leb", "answer": "ch" },
                { "word": "_ałas", "answer": "h" },
                { "word": "o_ota", "answer": "ch" },
                { "word": "_orągiew", "answer": "ch" },
                { "word": "_ytry", "answer": "ch" },
                { "word": "_erbatnik", "answer": "h" },
                { "word": "_ojrak", "answer": "h" },
                { "word": "_luba", "answer": "ch" },
                { "word": "plu_a", "answer": "ch" },
                { "word": "o_ronić", "answer": "ch" },
                { "word": "re_abilitacja", "answer": "h" },
                { "word": "_ulajnoga", "answer": "h" },
                { "word": "mu_a", "answer": "ch" },
                { "word": "_odowla", "answer": "h" },
                { "word": "_ojny", "answer": "h" },
                { "word": "_rupki", "answer": "ch" },
                { "word": "_arakter", "answer": "ch" },
                { "word": "_oinka", "answer": "ch" },
                { "word": "dru_", "answer": "h" },
                { "word": "_łopak", "answer": "ch" },
                { "word": "_ałas", "answer": "h" },
                { "word": "_amak", "answer": "h" },
                { "word": "bo_ater", "answer": "h" },
                { "word": "_istoria", "answer": "h" },
                { "word": "_ipopotam", "answer": "h" }
            ];

            wordsList02 = [
                    { "word": "_aba", "answer": "ż" },
                    { "word": "ma_enie", "answer": "rz" },
                    { "word": "ko_yść", "answer": "rz" },
                    { "word": "wie_a", "answer": "ż" },
                    { "word": "pa_ysta", "answer": "rz" },
                    { "word": "bie_nia", "answer": "ż" },
                    { "word": "_eglować", "answer": "ż" },
                    { "word": "obro_a", "answer": "ż" },
                    { "word": "pla_a", "answer": "ż" },
                    { "word": "t_ask", "answer": "rz" },
                    { "word": "_urek", "answer": "ż" },
                    { "word": "je_", "answer": "ż" },
                    { "word": "u_ądzenie", "answer": "rz" },
                    { "word": "spo_ądzić", "answer": "rz" }
                ];                

            wordsList03 = [
                { "word":"j_ż", "answer": "u" },
                { "word":"b_t", "answer": "u" },
                { "word":"m_cha", "answer": "u" },
                { "word":"k_ra", "answer": "u" }, 
                { "word":"autob_s", "answer": "u" },
                { "word":"komp_ter", "answer": "u" },
                { "word":"m_szelka", "answer": "u" },
                { "word":"b_rza", "answer": "u" },
                { "word":"_branie", "answer": "u" },
                { "word":"b_telka", "answer": "u" },
                { "word":"k_bek", "answer": "u" },
                { "word":"kr_l", "answer": "ó" },
                { "word":"w_zek", "answer": "ó" },
                { "word":"ch_r", "answer": "ó" },
                { "word":"pr_ba", "answer": "ó" },
                { "word":"g_rka", "answer": "ó" },
                { "word":"b_l", "answer": "ó" },
                { "word":"st_ł", "answer": "ó" },
                { "word":"kt_ry", "answer": "ó" },
                { "word":"m_wić", "answer": "ó" },
            ];
        };
        prepare();
    </script>

<div  class="modal fade" id="showErrs" tabindex="-1" role="dialog" aria-labelledby="showErrsTitle" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Słówka, w których był błąd:</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                    <ul id="list_of_errors">
                            Jak na razie nie ma żadnych błędów!
                    </ul>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary" data-dismiss="modal">Zamknij</button>
            </div>
          </div>
        </div>
</div>

<div  class="modal fade" id="setWordList" tabindex="-1" role="dialog" aria-labelledby="setWordListTitle" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Proszę ustaw zestaw słówek:</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <p><span style="font-size: small">Ustawienie nowego zestawu wyzeruje statystyki.</span></p>
              <button type="button" class="btn btn-primary" onclick="setWordList01()" data-dismiss="modal">H i CH</button>
              <button type="button" class="btn btn-primary" onclick="setWordList02()" data-dismiss="modal">RZ i Ż</button>
              <button type="button" class="btn btn-primary" onclick="setWordList03()" data-dismiss="modal">U i Ó</button>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Anuluj</button>
            </div>

        </div>
        </div>
</div>
</body>
</html>